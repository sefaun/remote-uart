upstream websocket {
  server localhost:1883;
}

server {
  listen 8883;

  location / {
    proxy_pass http://websocket;
    proxy_http_version  1.1;
    proxy_set_header    Upgrade $http_upgrade;
    proxy_set_header    Connection "upgrade";
    proxy_set_header    Host $http_host;
    proxy_set_header    X-Real-IP $remote_addr;
  }
}